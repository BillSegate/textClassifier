In differential geometry, Santaló's formula describes how to integrate a function on the unit sphere bundle of a Riemannian manifold by first integrating along every geodesic separately and then 
over the space of all geodesics. It is a standard tool in integral geometry and has applications in isoperimetric and rigidity results. The formula is named after Luis Santaló, who first proved the result in 1952.

Formulation
Let 
  
    
      
        (
        M
        ,
        ∂
        M
        ,
        g
        )
      
    
    {\displaystyle (M,\partial M,g)}
   be a compact, oriented Riemannian manifold with boundary. Then for a function 
  
    
      
        f
        :
        S
        M
        →
        
          C
        
      
    
    {\displaystyle f:SM\rightarrow \mathbb {C} }
  , Santaló's formula takes the form

  
    
      
        
          ∫
          
            S
            M
          
        
        f
        (
        x
        ,
        v
        )
        
        d
        μ
        (
        x
        ,
        v
        )
        =
        
          ∫
          
            
              ∂
              
                +
              
            
            S
            M
          
        
        
          [
          
            
              ∫
              
                0
              
              
                τ
                (
                x
                ,
                v
                )
              
            
            f
            (
            
              φ
              
                t
              
            
            (
            x
            ,
            v
            )
            )
            
            d
            t
          
          ]
        
        ⟨
        v
        ,
        ν
        (
        x
        )
        ⟩
        
        d
        σ
        (
        x
        ,
        v
        )
        ,
      
    
    {\displaystyle \int _{SM}f(x,v)\,d\mu (x,v)=\int _{\partial _{+}SM}\left[\int _{0}^{\tau (x,v)}f(\varphi _{t}(x,v))\,dt\right]\langle v,\nu (x)\rangle \,d\sigma (x,v),}
  where

  
    
      
        (
        
          φ
          
            t
          
        
        
          )
          
            t
          
        
      
    
    {\displaystyle (\varphi _{t})_{t}}
   is the geodesic flow and 
  
    
      
        τ
        (
        x
        ,
        v
        )
        =
        sup
        {
        t
        ≥
        0
        :
        ∀
        s
        ∈
        [
        0
        ,
        t
        ]
        :
         
        
          φ
          
            s
          
        
        (
        x
        ,
        v
        )
        ∈
        S
        M
        }
      
    
    {\displaystyle \tau (x,v)=\sup\{t\geq 0:\forall s\in [0,t]:~\varphi _{s}(x,v)\in SM\}}
   is the exit time of the geodesic with initial conditions 
  
    
      
        (
        x
        ,
        v
        )
        ∈
        S
        M
      
    
    {\displaystyle (x,v)\in SM}
  ,

  
    
      
        μ
      
    
    {\displaystyle \mu }
   and 
  
    
      
        σ
      
    
    {\displaystyle \sigma }
   are the Riemannian volume forms with respect to the Sasaki metric on 
  
    
      
        S
        M
      
    
    {\displaystyle SM}
   and 
  
    
      
        ∂
        S
        M
      
    
    {\displaystyle \partial SM}
   respectively (
  
    
      
        μ
      
    
    {\displaystyle \mu }
   is also called Liouville measure),

  
    
      
        ν
      
    
    {\displaystyle \nu }
   is the inward-pointing unit normal to 
  
    
      
        ∂
        M
      
    
    {\displaystyle \partial M}
   and 
  
    
      
        
          ∂
          
            +
          
        
        S
        M
        :=
        {
        (
        x
        ,
        v
        )
        ∈
        S
        M
        :
        x
        ∈
        ∂
        M
        ,
        ⟨
        v
        ,
        ν
        (
        x
        )
        ⟩
        ≥
        0
        }
      
    
    {\displaystyle \partial _{+}SM:=\{(x,v)\in SM:x\in \partial M,\langle v,\nu (x)\rangle \geq 0\}}
   the influx-boundary, which should be thought of as parametrization of the space of geodesics.

Validity
Under the assumptions that 

  
    
      
        M
      
    
    {\displaystyle M}
   is non-trapping (i.e. 
  
    
      
        τ
        (
        x
        ,
        v
        )
        <
        ∞
      
    
    {\displaystyle \tau (x,v)<\infty }
   for all 
  
    
      
        (
        x
        ,
        v
        )
        ∈
        S
        M
      
    
    {\displaystyle (x,v)\in SM}
  ) and

  
    
      
        ∂
        M
      
    
    {\displaystyle \partial M}
   is strictly convex (i.e. the second fundamental form 
  
    
      
        I
        
          I
          
            ∂
            M
          
        
        (
        x
        )
      
    
    {\displaystyle II_{\partial M}(x)}
   is positive definite for every 
  
    
      
        x
        ∈
        ∂
        M
      
    
    {\displaystyle x\in \partial M}
  ),Santaló's formula is valid for all 
  
    
      
        f
        ∈
        
          C
          
            ∞
          
        
        (
        M
        )
      
    
    {\displaystyle f\in C^{\infty }(M)}
  . In this case it is equivalent to the following identity of measures:

  
    
      
        
          Φ
          
            ∗
          
        
        d
        μ
        (
        x
        ,
        v
        ,
        t
        )
        =
        ⟨
        ν
        (
        x
        )
        ,
        x
        ⟩
        d
        σ
        (
        x
        ,
        v
        )
        d
        t
        ,
      
    
    {\displaystyle \Phi ^{*}d\mu (x,v,t)=\langle \nu (x),x\rangle d\sigma (x,v)dt,}
  where 
  
    
      
        Ω
        =
        {
        (
        x
        ,
        v
        ,
        t
        )
        :
        (
        x
        ,
        v
        )
        ∈
        
          ∂
          
            +
          
        
        S
        M
        ,
        t
        ∈
        (
        0
        ,
        τ
        (
        x
        ,
        v
        )
        )
        }
      
    
    {\displaystyle \Omega =\{(x,v,t):(x,v)\in \partial _{+}SM,t\in (0,\tau (x,v))\}}
   and 
  
    
      
        Φ
        :
        Ω
        →
        S
        M
      
    
    {\displaystyle \Phi :\Omega \rightarrow SM}
   is defined by 
  
    
      
        Φ
        (
        x
        ,
        v
        ,
        t
        )
        =
        
          φ
          
            t
          
        
        (
        x
        ,
        v
        )
      
    
    {\displaystyle \Phi (x,v,t)=\varphi _{t}(x,v)}
  . In particular
this implies that the geodesic X-ray transform 
  
    
      
        I
        f
        (
        x
        ,
        v
        )
        =
        
          ∫
          
            0
          
          
            τ
            (
            x
            ,
            v
            )
          
        
        f
        (
        
          φ
          
            t
          
        
        (
        x
        ,
        v
        )
        )
        
        d
        t
      
    
    {\displaystyle If(x,v)=\int _{0}^{\tau (x,v)}f(\varphi _{t}(x,v))\,dt}
    extends to a bounded linear map 
  
    
      
        I
        :
        
          L
          
            1
          
        
        (
        S
        M
        ,
        μ
        )
        →
        
          L
          
            1
          
        
        (
        
          ∂
          
            +
          
        
        S
        M
        ,
        
          σ
          
            ν
          
        
        )
      
    
    {\displaystyle I:L^{1}(SM,\mu )\rightarrow L^{1}(\partial _{+}SM,\sigma _{\nu })}
  , where 
  
    
      
        d
        
          σ
          
            ν
          
        
        (
        x
        ,
        v
        )
        =
        ⟨
        v
        ,
        ν
        (
        x
        )
        ⟩
        
        d
        σ
        (
        x
        ,
        v
        )
      
    
    {\displaystyle d\sigma _{\nu }(x,v)=\langle v,\nu (x)\rangle \,d\sigma (x,v)}
   and thus there is the following, 
  
    
      
        
          L
          
            1
          
        
      
    
    {\displaystyle L^{1}}
  -version of Santaló's formula:

  
    
      
        
          ∫
          
            S
            M
          
        
        f
        
        d
        μ
        =
        
          ∫
          
            
              ∂
              
                +
              
            
            S
            M
          
        
        I
        f
         
        d
        
          σ
          
            ν
          
        
        
        
          for all 
        
        f
        ∈
        
          L
          
            1
          
        
        (
        S
        M
        ,
        μ
        )
        .
      
    
    {\displaystyle \int _{SM}f\,d\mu =\int _{\partial _{+}SM}If~d\sigma _{\nu }\quad {\text{for all }}f\in L^{1}(SM,\mu ).}
  If the non-trapping or the convexity condition from above fail, then there is a set 
  
    
      
        E
        ⊂
        S
        M
      
    
    {\displaystyle E\subset SM}
   of positive measure, such that the geodesics emerging from 
  
    
      
        E
      
    
    {\displaystyle E}
   either fail to hit the boundary of 
  
    
      
        M
      
    
    {\displaystyle M}
   or hit it non-transversely. In this case Santaló's formula only remains true for functions with support disjoint from this exceptional set 
  
    
      
        E
      
    
    {\displaystyle E}
  .

Proof
The following proof is taken from [ Lemma 3.3], adapted to the (simpler) setting when conditions 1) and 2) from above are true. Santaló's formula follows from the following two ingredients, noting that 
  
    
      
        
          ∂
          
            0
          
        
        S
        M
        =
        {
        (
        x
        ,
        v
        )
        :
        ⟨
        ν
        (
        x
        )
        ,
        v
        ⟩
        =
        0
        }
      
    
    {\displaystyle \partial _{0}SM=\{(x,v):\langle \nu (x),v\rangle =0\}}
   has measure zero.

An integration by parts formula for the geodesic vector field 
  
    
      
        X
      
    
    {\displaystyle X}
  :
  
    
      
        
          ∫
          
            S
            M
          
        
        X
        u
         
        d
        μ
        =
        −
        
          ∫
          
            
              ∂
              
                +
              
            
            S
            M
          
        
        u
         
        d
        
          σ
          
            ν
          
        
        
        
          for all 
        
        u
        ∈
        
          C
          
            ∞
          
        
        (
        S
        M
        )
      
    
    {\displaystyle \int _{SM}Xu~d\mu =-\int _{\partial _{+}SM}u~d\sigma _{\nu }\quad {\text{for all }}u\in C^{\infty }(SM)}
  The construction of a resolvent for the transport equation 
  
    
      
        X
        u
        =
        −
        f
      
    
    {\displaystyle Xu=-f}
  :
  
    
      
        ∃
        R
        :
        
          C
          
            c
          
          
            ∞
          
        
        (
        S
        M
        ∖
        
          ∂
          
            0
          
        
        S
        M
        )
        →
        
          C
          
            ∞
          
        
        (
        S
        M
        )
        :
        X
        R
        f
        =
        −
        f
        
           and 
        
        R
        f
        
          |
          
            
              ∂
              
                +
              
            
            S
            M
          
        
        =
        I
        f
        
        
          for all 
        
        f
        ∈
        
          C
          
            c
          
          
            ∞
          
        
        (
        S
        M
        ∖
        
          ∂
          
            0
          
        
        S
        M
        )
      
    
    {\displaystyle \exists R:C_{c}^{\infty }(SM\smallsetminus \partial _{0}SM)\rightarrow C^{\infty }(SM):XRf=-f{\text{ and }}Rf\vert _{\partial _{+}SM}=If\quad {\text{for all }}f\in C_{c}^{\infty }(SM\smallsetminus \partial _{0}SM)}
  For the integration by parts formula, recall that 
  
    
      
        X
      
    
    {\displaystyle X}
   leaves the Liouville-measure 
  
    
      
        μ
      
    
    {\displaystyle \mu }
   invariant and hence 
  
    
      
        X
        u
        =
        
          div
          
            G
          
        
        ⁡
        (
        u
        X
        )
      
    
    {\displaystyle Xu=\operatorname {div} _{G}(uX)}
  , the divergence with respect to the Sasaki-metric 
  
    
      
        G
      
    
    {\displaystyle G}
  . The result thus follows from the divergence theorem and the observation that 
  
    
      
        ⟨
        X
        (
        x
        ,
        v
        )
        ,
        N
        (
        x
        ,
        v
        )
        
          ⟩
          
            G
          
        
        =
        ⟨
        v
        ,
        ν
        (
        x
        )
        
          ⟩
          
            g
          
        
      
    
    {\displaystyle \langle X(x,v),N(x,v)\rangle _{G}=\langle v,\nu (x)\rangle _{g}}
  , where 
  
    
      
        N
      
    
    {\displaystyle N}
   is the inward-pointing unit-normal to 
  
    
      
        ∂
        S
        M
      
    
    {\displaystyle \partial SM}
  . The resolvent is explicitly given by 
  
    
      
        R
        f
        (
        x
        ,
        v
        )
        =
        
          ∫
          
            0
          
          
            τ
            (
            x
            ,
            v
            )
          
        
        f
        (
        
          φ
          
            t
          
        
        (
        x
        ,
        v
        )
        )
        
        d
        t
      
    
    {\displaystyle Rf(x,v)=\int _{0}^{\tau (x,v)}f(\varphi _{t}(x,v))\,dt}
   and the  mapping property 
  
    
      
        
          C
          
            c
          
          
            ∞
          
        
        (
        S
        M
        ∖
        
          ∂
          
            0
          
        
        S
        M
        )
        →
        
          C
          
            ∞
          
        
        (
        S
        M
        )
      
    
    {\displaystyle C_{c}^{\infty }(SM\smallsetminus \partial _{0}SM)\rightarrow C^{\infty }(SM)}
   follows from the smoothness of 
  
    
      
        τ
        :
        S
        M
        ∖
        
          ∂
          
            0
          
        
        S
        M
        →
        [
        0
        ,
        ∞
        )
      
    
    {\displaystyle \tau :SM\smallsetminus \partial _{0}SM\rightarrow [0,\infty )}
  , which is a consequence of the non-trapping and the convexity assumption.

References

Isaac Chavel (1995). "5.2 Santalo's formula". Riemannian Geometry: A Modern Introduction. Cambridge Tracts in Mathematics. Vol. 108. Cambridge University Press. ISBN 0-521-48578-9.